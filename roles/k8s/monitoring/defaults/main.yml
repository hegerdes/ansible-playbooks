---
# k8s-monitoring-role-defaults

k8s_grafana_agent_logs_config_path: conf/grafana-log-config.yml.j2
k8s_grafana_agent_metrics_config_path: conf/grafana-metrics-config.yml.j2
k8s_grafana_agent_traces_config_path: conf/grafana-traces-config.yml.j2

k8s_grafana_agent_logs_install: True
k8s_grafana_agent_logs_agent_config: '{{ lookup("template", k8s_grafana_agent_logs_config_path) | from_yaml }}'
k8s_grafana_agent_logs_agent_app_path: apps/grafana-log-agent.yml.j2
k8s_grafana_agent_metrics_install: True
k8s_grafana_agent_metrics_agent_config: '{{ lookup("template", k8s_grafana_agent_metrics_config_path) | from_yaml }}'
k8s_grafana_agent_metrics_agent_app_path: apps/grafana-metrics-agent.yml.j2
k8s_grafana_agent_traces_install: True
k8s_grafana_agent_traces_agent_config: '{{ lookup("template", k8s_grafana_agent_traces_config_path) | from_yaml }}'
k8s_grafana_agent_traces_agent_app_path: apps/grafana-traces-agent.yml.j2
k8s_grafana_agent_traces_strategies_config:
  default_strategy:
    param: 0.001
    type: probabilistic

### Node-Exporter ###
k8s_monitoring_install_node_exporter: True
# Version of the chart to deploy
k8s_node_exporter_chart_version: '{{ null | default(omit) }}'
# Node-Exporter helm values
# See: https://artifacthub.io/packages/helm/prometheus-community/prometheus-node-exporter
k8s_node_exporter_helm_values: {}

### Metrics-Server ###
k8s_monitoring_install_metrics_server: True
# Version of the chart to deploy
k8s_metrics_server_helm_chart_version: '{{ null | default(omit) }}'
# Metrics-Server helm values
# See: https://artifacthub.io/packages/helm/metrics-server/metrics-server
k8s_metrics_server_helm_values:
  args:
    - --kubelet-insecure-tls

### Kube-State-Metrics ###
k8s_monitoring_install_ksm: True
# Version of the chart to deploy
k8s_ksm_helm_chart_version: '{{ null | default(omit) }}'
# Metrics-Server helm values
# See: https://artifacthub.io/packages/helm/prometheus-community/kube-state-metrics
k8s_ksm_helm_values: {}

### K8s-Dashboard ###
k8s_monitoring_install_dashboard: True
# Version of the chart to deploy
k8s_dashboard_chart_version: '{{ null | default(omit) }}'
# k8s-dashboard helm values
# See: https://artifacthub.io/packages/helm/k8s-dashboard/kubernetes-dashboard
k8s_dashboard_helm_values: {}


### Grafana-Agent ###
k8s_monitoring_install_grafana_agent: True
k8s_monitoring_prometheus_remote_write:
  - url: https://prometheus-prod-01-eu-west-0.grafana.net/api/prom/push
    # basic_auth:
    #   username: '{{ vault_k8s_monitoring_prometheus_user }}'
    #   password: '{{ vault_k8s_monitoring_prometheus_pw }}'
    # headers:
    #   X-Scope-OrgID: anonymous

k8s_monitoring_loki_remote_write:
  - url: https://logs-prod-eu-west-0.grafana.net/loki/api/v1/push
    # basic_auth:
    #   username: '{{ vault_k8s_monitoring_loki_user }}'
    #   password: '{{ vault_k8s_monitoring_loki_pw }}'
    # external_labels:
    #   cluster: '{{ inventory_dir | basename }}'

k8s_monitoring_tempo_remote_write:
  - endpoint: tempo-eu-west-0.grafana.net:443
    # basic_auth:
    #     username: '{{ vault_k8s_monitoring_tempo_pw }}'
    #     password: '{{ vault_k8s_monitoring_tempo_user }}'
    # retry_on_failure:
    #     enabled: false
